<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>People</title>
<style>
  :root{
    --ink:#0d0d0d; --muted:#6b7280; --brand:#2f7d5f;
    --line:#e7ece9; --card:#ffffff; --chip:#e9f6f0;
    --shadow:0 6px 18px rgba(0,0,0,.06);
  }
  body{margin:0;font-family:system-ui,Arial,"Noto Sans KR";color:var(--ink);}
  .wrap{max-width:1200px;margin:0 auto;padding:8px;}

  .sec-h{margin:22px 0 12px;font-weight:800;color:var(--brand);}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;}
  @media (max-width:860px){ .grid{grid-template-columns:1fr;} }

  .card{
    display:flex; gap:18px; align-items:flex-start;
    background:var(--card); border:1px solid var(--line); border-radius:14px;
    padding:14px; box-shadow:var(--shadow);
  }
  .avatar{
    width:140px; height:170px; flex:0 0 140px;
    border-radius:10px; object-fit:cover; background:#f2f5f4; border:1px solid var(--line);
  }
  .meta{flex:1; min-width:0;}
  .name{font-size:22px; font-weight:800; color:#0f5aa0; margin:0 0 4px;}
  .line{height:1px; background:var(--line); margin:10px 0;}
  .row{display:flex; align-items:center; gap:8px; color:var(--muted); font-size:14px;}
  .row a{color:inherit; text-decoration:none;}
  .row a:hover{text-decoration:underline;}

  .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
  .chip{
    font-size:13px; color:#2b6f58;                  /* ✅ 관심분야 글씨 검정 */
    background:var(--chip);
    border:1px solid #cfe9dc; border-radius:999px; padding:4px 10px;
  }

  .mail{width:18px; height:18px;}
</style>
</head>
<body>
<div class="wrap" id="app"></div>

<script>
  const API_BASE = '<?= apiBase ?>';
  const API = API_BASE + '?mode=json';
  const app = document.getElementById('app');

  const iconMail = `
  <svg class="mail" viewBox="0 0 24 24" fill="none" stroke="#8aa39a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16v16H4z"/><path d="m22 6-10 7L2 6"/>
  </svg>`;

  const esc = s => String(s ?? '')
    .replace(/&/g,'&amp;').replace(/</g,'&lt;')
    .replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');

  const chips = str => {
    const arr = (str||'').split(/[,;|]/).map(x=>x.trim()).filter(Boolean);
    if (!arr.length) return '';
    return `<div class="chips">${arr.map(x=>`<span class="chip">${esc(x)}</span>`).join('')}</div>`;
  };

  const card = p => `
  <article class="card">
    <img class="avatar" src="${esc(p.photo)}" alt="${esc(p.name)}">
    <div class="meta">
      <h4 class="name">${esc(p.name)}</h4>
      <div class="line"></div>
      ${p.email ? `<div class="row">${iconMail}<a href="mailto:${esc(p.email)}">${esc(p.email)}</a></div>` : ''}
      ${chips(p.interest)}
    </div>
  </article>`;

  const section = sec => `
    <h3 class="sec-h">${esc(sec.title)}</h3>
    <div class="grid">${sec.people.map(card).join('')}</div>
  `;

  fetch(API)
    .then(r=>r.json())
    .then(({sections})=>{
      app.innerHTML = sections.map(section).join('');
    })
    .catch(err=>{
      console.error(err);
      app.innerHTML = '<p>데이터 로드 오류: 권한/시트를 확인하세요.</p>';
    });
</script>
</body>
</html>
